@model ITSecuritySymposium.Models.Post

@{
    ViewBag.Title = "Post";
}

<h2>Post</h2>

<p>
<strong>@Model.Author</strong> wrote on @Model.Created.ToShortDateString()
</p>

@Model.Content

<h2>Comments</h2>

<table>
    <tr>
        <th>
            Author
        </th>
        <th>
            Created
        </th>
        <th>
            Content
        </th>
        <th></th>
    </tr>

@foreach (var item in Model.Comments) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Author)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Created)
        </td>
        <td>
            @Html.Raw(item.Content)
            @*@Html.DisplayFor(modelItem => item.Content)*@
        </td>
        <td>
            @using(Html.BeginForm("DeleteComment", "Xss", new {id = item.Id, postid = Model.Id})){
                @Html.AntiForgeryToken()
                <input type="submit" value="Delete" />
            }
        </td>
    </tr>
}

</table>

@using (Html.BeginForm("CreateComment", "Xss", new { id = @Model.Id })) { 
    <fieldset>
        <legend>New Comment</legend>

        @Html.AntiForgeryToken()
        
        <div class="editor-label">
            <label for="author">Author: </label>
        </div>
        <div class="editor-field">
            <input type="text" name="author" value="@User.Identity.Name" />
        </div>

        <div class="editor-label">
            <label for="content">Comment: </label>
        </div>
        <div class="editor-field">
            <textarea name="content"></textarea>
        </div>

        <p>
            <input type="submit" value="Save" /> | @Html.ActionLink("Cancel", "Index")
        </p>
    </fieldset>
}